import{A as Te,B as Ee,C as Fe,D as Me,E as Pe,F as De,G as Le,H as P,b as ce,c as me,i as de,j as pe,k as ue,l as Q,m as fe,n as z,o as he,p as ve,q as ge,r as ye,s as _e,t as Se,u as Ce,v as be,w as Re,x as xe,y as Ie,z as we}from"./chunk-JIRZER2E.js";import{a as O,b as M,d as N,e as V,j as U,l as $,m as B,q as G,r as H,s as q,t as ae,u as se}from"./chunk-6AOILKHN.js";import{a as _}from"./chunk-45VFKY7Y.js";import{a as Z}from"./chunk-EAQ7ETCC.js";import{c as ne,k as le,m as h,o as te}from"./chunk-NCDLYK7T.js";import{$a as p,Aa as g,Eb as l,Fb as a,Gb as S,Hb as A,Ib as k,Kb as I,Nb as y,Nc as E,Oc as F,Pb as f,Rc as re,Tb as W,Ub as X,Vb as Y,Wb as ie,Xb as m,Yb as ee,Zb as w,_a as c,ec as oe,ga as T,ha as L,ja as R,ka as x,qa as C,ra as j,tb as u,vb as d}from"./chunk-H2VV5PGB.js";var J=(()=>{let e=class e{constructor(i){this._http=i,this.URL="http://20.49.205.136:3000/privileges"}getPrivileges(){return this._http.get(this.URL)}};e.\u0275fac=function(o){return new(o||e)(g(ne))},e.\u0275prov=C({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function qe(t,e){t&1&&(l(0,"div")(1,"span",18),m(2,"Role Title must contain only uppercase letters."),a()())}function Qe(t,e){if(t&1){let s=I();l(0,"div")(1,"label",19)(2,"input",20),y("change",function(o){let n=R(s).$implicit,v=f();return x(v.onprivilegeSelect(n,o))}),a(),m(3),a()()}if(t&2){let s=e.$implicit;c(3),w(" ",s.name," ")}}var Oe=(()=>{let e=class e{constructor(i,o,r,n,v){this.privilegeService=i,this.roleService=o,this.formBuilder=r,this.router=n,this.encryptionService=v,this.privileges=[],this.selectedPrivileges=[],this.myForm=this.formBuilder.group({roleTitle:["",[M.pattern("[A-Z]+"),M.required]]})}onprivilegeSelect(i,o){if(o.target.checked)this.selectedPrivileges.push(i);else{let r=this.selectedPrivileges.indexOf(i);r!==-1&&this.selectedPrivileges.splice(r,1)}console.log(this.selectedPrivileges)}ngOnInit(){this.getPrivileges()}getPrivileges(){this.privilegeService.getPrivileges().subscribe(i=>{console.log(i),this.privileges=i},i=>{console.log(i)})}onSubmit(){let i=this.myForm.get("roleTitle")?.value,o=this.selectedPrivileges.map(n=>n.id),r={name:i,privileges:o};this.roleService.addRole(r).subscribe(n=>{let v=localStorage.getItem("authorities");this.encryptionService.decrypt(v,"2f7").includes("READ::ROLE")?this.router.navigate(["/home/roles"]):this.router.navigate(["/home"])},n=>{console.error("Error adding role:",n)})}};e.\u0275fac=function(o){return new(o||e)(p(J),p(P),p(q),p(h),p(_))},e.\u0275cmp=T({type:e,selectors:[["app-add-role"]],decls:21,vars:4,consts:[[1,"pcoded-main-container"],[1,"pcoded-wrapper"],[1,"pcoded-content"],[1,"pcoded-inner-content"],[1,"main-body"],[1,"page-wrapper"],[1,"row"],[1,"col-sm-12"],[1,"card"],[1,"card-header"],[1,"card-body"],[1,"mb-9",3,"formGroup","ngSubmit"],[1,"form-floating"],["type","text","id","roleTitle","formControlName","roleTitle","pattern","[A-Za-z]+","required","","placeholder","ROLE TITLE",1,"form-control"],["for","roleTitle"],[4,"ngIf"],[4,"ngFor","ngForOf"],["type","submit",1,"btn","btn-primary",3,"disabled"],[1,"error-message"],[1,"checkbox-label"],["type","checkbox",1,"styled-checkbox",3,"change"]],template:function(o,r){if(o&1&&(l(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"div",6)(7,"div",7)(8,"div",8)(9,"div",9)(10,"h5"),m(11,"Create Role"),a()(),l(12,"div",10)(13,"form",11),y("ngSubmit",function(){return r.onSubmit()}),l(14,"div",12),S(15,"input",13)(16,"label",14),u(17,qe,3,0,"div",15),a(),u(18,Qe,4,1,"div",16),l(19,"button",17),m(20," Add "),a()()()()()()()()()()()()),o&2){let n;c(13),d("formGroup",r.myForm),c(4),d("ngIf",((n=r.myForm.get("roleTitle"))==null?null:n.invalid)&&(((n=r.myForm.get("roleTitle"))==null?null:n.dirty)||((n=r.myForm.get("roleTitle"))==null?null:n.touched))),c(),d("ngForOf",r.privileges),c(),d("disabled",r.myForm.invalid)}},dependencies:[E,F,U,O,N,V,G,H,$,B],styles:[".error-message[_ngcontent-%COMP%]{color:red}"]});let t=e;return t})();function ze(t,e){t&1&&(l(0,"div")(1,"span",18),m(2,"Role Title must contain only uppercase letters."),a()())}function Ze(t,e){if(t&1){let s=I();l(0,"div")(1,"label",19)(2,"input",20),y("change",function(o){let n=R(s).$implicit,v=f();return x(v.onPrivilegeSelect(n,o))}),a(),m(3),a()()}if(t&2){let s=e.$implicit,i=f();c(2),d("checked",i.isSelected(s)),c(),w(" ",s.name," ")}}var Ne=(()=>{let e=class e{constructor(i,o,r,n,v){this.router=i,this.fb=o,this.roleService=r,this.privilegeService=n,this.route=v,this.selectedPrivileges=[],this.privileges=[],this.myForm=this.fb.group({roleTitle:["",[M.pattern("[A-Z]+"),M.required]]})}ngOnInit(){this.id=this.route.snapshot.paramMap.get("id"),console.log(this.id),this.getRoleById(this.id),this.getPrivileges()}getPrivileges(){this.privilegeService.getPrivileges().subscribe(i=>{console.log(i),this.privileges=i,this.myForm.patchValue({id:this.role.id,roleTitle:this.role.name})},i=>{console.log(i)})}getRoleById(i){this.roleService.getRoleById(i).subscribe({next:o=>{console.log(o),this.role=o,this.selectedPrivileges=this.role.privilegeId,this.myForm.patchValue({roleTitle:this.role.name})},error:o=>{console.log(o)}})}isSelected(i){return this.selectedPrivileges.includes(i.id)}onPrivilegeSelect(i,o){if(o.target.checked)this.selectedPrivileges.push(i.id);else{let r=this.selectedPrivileges.indexOf(i.id);r!==-1&&this.selectedPrivileges.splice(r,1)}console.log(this.selectedPrivileges)}onSubmit(){let i=this.myForm.get("roleTitle")?.value,o={id:this.id,name:i,privilegeId:this.selectedPrivileges};this.roleService.updateRole(o.id,o).subscribe(r=>{this.router.navigate(["/home/roles"])},r=>{console.error("Error adding role:",r)})}};e.\u0275fac=function(o){return new(o||e)(p(h),p(q),p(P),p(J),p(le))},e.\u0275cmp=T({type:e,selectors:[["app-update-role"]],decls:21,vars:4,consts:[[1,"pcoded-main-container"],[1,"pcoded-wrapper"],[1,"pcoded-content"],[1,"pcoded-inner-content"],[1,"main-body"],[1,"page-wrapper"],[1,"row"],[1,"col-sm-12"],[1,"card"],[1,"card-header"],[1,"card-body"],[1,"mb-9",3,"formGroup","ngSubmit"],[1,"form-floating"],["type","text","id","roleTitle","formControlName","roleTitle","pattern","[A-Za-z]+","required","","placeholder","ROLE TITLE",1,"form-control"],["for","roleTitle"],[4,"ngIf"],[4,"ngFor","ngForOf"],["type","submit",1,"btn","btn-primary",3,"disabled"],[1,"error-message"],[1,"checkbox-label"],["type","checkbox",1,"styled-checkbox",3,"checked","change"]],template:function(o,r){if(o&1&&(l(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"div",6)(7,"div",7)(8,"div",8)(9,"div",9)(10,"h5"),m(11,"Update Role"),a()(),l(12,"div",10)(13,"form",11),y("ngSubmit",function(){return r.onSubmit()}),l(14,"div",12),S(15,"input",13)(16,"label",14),u(17,ze,3,0,"div",15),a(),u(18,Ze,4,2,"div",16),l(19,"button",17),m(20," Update "),a()()()()()()()()()()()()),o&2){let n;c(13),d("formGroup",r.myForm),c(4),d("ngIf",((n=r.myForm.get("roleTitle"))==null?null:n.invalid)&&(((n=r.myForm.get("roleTitle"))==null?null:n.dirty)||((n=r.myForm.get("roleTitle"))==null?null:n.touched))),c(),d("ngForOf",r.privileges),c(),d("disabled",r.myForm.invalid||r.selectedPrivileges.length===0)}},dependencies:[E,F,U,O,N,V,G,H,$,B],styles:[".error-message[_ngcontent-%COMP%]{color:red}"]});let t=e;return t})();function Je(t,e){if(t&1&&(l(0,"td",18),m(1),a()),t&2){let s=e.$implicit;c(),ee(s.id)}}function Ke(t,e){t&1&&(l(0,"th",19),m(1,"Role"),a())}function We(t,e){if(t&1&&(l(0,"td",18),m(1),a()),t&2){let s=e.$implicit;c(),ee(s.name)}}function Xe(t,e){t&1&&(l(0,"th",19),m(1," Privileges "),a())}function Ye(t,e){if(t&1&&(l(0,"span"),m(1),S(2,"br"),a()),t&2){let s=e.$implicit;c(),w(" ",s.name," ")}}function et(t,e){if(t&1&&(l(0,"td",18),u(1,Ye,3,1,"span",20),a()),t&2){let s=e.$implicit;c(),d("ngForOf",s.privileges)}}function tt(t,e){t&1&&(l(0,"th",19),m(1," Actions "),a())}function it(t,e){if(t&1){let s=I();l(0,"button",23),y("click",function(){R(s);let o=f().$implicit,r=f();return x(r.onEditClick(o.id))}),l(1,"mat-icon"),m(2,"edit"),a()()}}function ot(t,e){if(t&1){let s=I();l(0,"button",24),y("click",function(){R(s);let o=f().$implicit,r=f();return x(r.delete(o.id))}),l(1,"mat-icon"),m(2,"delete"),a()()}}function rt(t,e){if(t&1&&(l(0,"td",18),u(1,it,3,0,"button",21)(2,ot,3,0,"button",22),a()),t&2){let s=f();c(),d("ngIf",s.updateRole),c(),d("ngIf",s.deleteRole)}}function nt(t,e){t&1&&S(0,"tr",25)}function lt(t,e){t&1&&S(0,"tr",26)}function at(t,e){if(t&1&&(l(0,"tr",27)(1,"td",28),m(2),a()()),t&2){f();let s=ie(9);c(2),w(' No data matching the filter "',s.value,'" ')}}var st=()=>[5,10,25,100],Ve=(()=>{let e=class e{ngOnInit(){let i=localStorage.getItem("authorities");this.authorities=this.encryptionService.decrypt(i,"2f7"),console.log(this.authorities),this.authorities.includes("EDIT::ROLE")&&(this.updateRole=!0),this.authorities.includes("DELETE::ROLE")&&(this.deleteRole=!0),this.getRoles()}constructor(i,o,r){this.router=i,this.roleService=o,this.encryptionService=r,this.displayedColumns=["Role","Privileges","Actions"],this.authorities="",this.updateRole=!1,this.deleteRole=!1}applyFilter(i){let o=i.target.value;this.dataSource.filter=o.trim().toLowerCase(),this.dataSource.paginator&&this.dataSource.paginator.firstPage()}getRoles(){this.roleService.getRoles().subscribe({next:i=>{console.log(i),this.dataSource=new Fe(i),this.dataSource.sort=this.sort,this.dataSource.paginator=this.paginator},error:i=>{console.log(i)}})}onEditClick(i){this.router.navigate(["/home/roles/update/"+i])}delete(i){this.roleService.deleteRole(i).subscribe({next:o=>{this.getRoles()},error:console.log})}};e.\u0275fac=function(o){return new(o||e)(p(h),p(P),p(_))},e.\u0275cmp=T({type:e,selectors:[["app-list-role"]],viewQuery:function(o,r){if(o&1&&(W(Q,5),W(z,5)),o&2){let n;X(n=Y())&&(r.paginator=n.first),X(n=Y())&&(r.sort=n.first)}},decls:26,vars:5,consts:[[1,"pcoded-main-container"],[1,"pcoded-wrapper"],[1,"pcoded-content"],[1,"pcoded-inner-content"],[1,"main-body"],["matInput","","placeholder","Ex. ADMIN",3,"keyup"],["input",""],[1,"table-container"],["mat-table","","matSort","",3,"dataSource"],["mat-cell","",4,"matCellDef"],["matColumnDef","Role"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["matColumnDef","Privileges"],["matColumnDef","Actions"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["class","mat-row",4,"matNoDataRow"],["aria-label","Select page of users",3,"pageSizeOptions"],["mat-cell",""],["mat-header-cell","","mat-sort-header",""],[4,"ngFor","ngForOf"],["mat-icon-button","","color","primary",3,"click",4,"ngIf"],["mat-icon-button","","color","warn",3,"click",4,"ngIf"],["mat-icon-button","","color","primary",3,"click"],["mat-icon-button","","color","warn",3,"click"],["mat-header-row",""],["mat-row",""],[1,"mat-row"],["colspan","4",1,"mat-cell"]],template:function(o,r){o&1&&(l(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"mat-form-field")(6,"mat-label"),m(7,"Filter"),a(),l(8,"input",5,6),y("keyup",function(v){return r.applyFilter(v)}),a()(),l(10,"div",7)(11,"table",8),u(12,Je,2,1,"td",9),A(13,10),u(14,Ke,2,0,"th",11)(15,We,2,1,"td",9),k(),A(16,12),u(17,Xe,2,0,"th",11)(18,et,2,1,"td",9),k(),A(19,13),u(20,tt,2,0,"th",11)(21,rt,3,2,"td",9),k(),u(22,nt,1,0,"tr",14)(23,lt,1,0,"tr",15)(24,at,3,1,"tr",16),a(),S(25,"mat-paginator",17),a()()()()()()),o&2&&(c(11),d("dataSource",r.dataSource),c(11),d("matHeaderRowDef",r.displayedColumns),c(),d("matRowDefColumns",r.displayedColumns),c(2),d("pageSizeOptions",oe(4,st)))},dependencies:[E,F,ge,_e,Re,Se,ye,xe,Ce,be,Ie,we,Te,Q,z,he,Me,pe,de,De,ce],styles:[".visually-hidden[_ngcontent-%COMP%]{position:absolute;left:-9999px;width:1px;height:1px;overflow:hidden}"]});let t=e;return t})();var Ue=(()=>{let e=class e{constructor(i,o){this.encryptionService=i,this.router=o}canActivate(i,o){let r=localStorage.getItem("authorities");return this.encryptionService.decrypt(r,"2f7").includes("READ::ROLE")?!0:(this.router.navigate(["/notfound"]),!1)}};e.\u0275fac=function(o){return new(o||e)(g(_),g(h))},e.\u0275prov=C({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var $e=(()=>{let e=class e{constructor(i,o){this.encryptionService=i,this.router=o}canActivate(i,o){let r=localStorage.getItem("authorities");return this.encryptionService.decrypt(r,"2f7").includes("ADD::ROLE")?!0:(this.router.navigate(["/notfound"]),!1)}};e.\u0275fac=function(o){return new(o||e)(g(_),g(h))},e.\u0275prov=C({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var Be=(()=>{let e=class e{constructor(i,o){this.encryptionService=i,this.router=o}canActivate(i,o){let r=localStorage.getItem("authorities");return this.encryptionService.decrypt(r,"2f7").includes("EDIT::ROLE")?!0:(this.router.navigate(["/notfound"]),!1)}};e.\u0275fac=function(o){return new(o||e)(g(_),g(h))},e.\u0275prov=C({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var ct=[{path:"",component:Ve,canActivate:[Z,Ue]},{path:"add",component:Oe,canActivate:[Z,$e]},{path:"update/:id",component:Ne,canActivate:[Z,Be]}],Ge=(()=>{let e=class e{};e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=L({type:e}),e.\u0275inj=j({imports:[te.forChild(ct),te]});let t=e;return t})();var ti=(()=>{let e=class e{};e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=L({type:e}),e.\u0275inj=j({imports:[re,Ge,ae,se,Ee,fe,ve,Pe,Le,ue,me]});let t=e;return t})();export{ti as a};
